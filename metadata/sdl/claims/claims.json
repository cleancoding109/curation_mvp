{
  "table_name": "claims",
  "description": "Standardized Claims Data",
  "pipeline_type": "standardization",
  "critical": true,
  "enable_deduplication": true,
  "watermark_column": "ingestion_timestamp",
  "lookback_interval": "2 HOURS",
  "transformation_sql_path": "query/claims.sql",
  "source_schema": "unified_dev",
  "source_table": "unified_claims_scd2",
  "target_schema": "standardized_data_layer",
  "target_table": "claims",
  "source_timezone": "America/New_York",
  "load_strategy": {
    "type": "scd2",
    "business_keys": ["claim_id"],
    "scd2_mode": {
      "historical": "passthrough",
      "incremental": "framework_managed"
    },
    "scd2_columns": {
      "effective_start_date": "effective_start_date",
      "effective_end_date": "effective_end_date",
      "is_current": "is_current"
    }
  },
  "business_key_columns": ["claim_id"],
  "dedup_order_columns": [
    "event_timestamp DESC",
    "ingestion_timestamp DESC"
  ],
  "hash_keys": {
    "_pk_hash": {
      "description": "Entity Hash (Merge Key)",
      "target_col": "row_hash",
      "algorithm": "SHA2-256",
      "columns": ["claim_id", "source_system"]
    },
    "_diff_hash": {
      "description": "Change Hash (SCD2 Change Detection)",
      "target_col": "business_diff_hash",
      "algorithm": "SHA2-256",
      "track_columns": ["claimant_id", "policy_number", "claim_type", "step_name", "step_status", "adjuster_id", "claim_decision", "denial_reason", "claim_amount", "approved_amount", "event_timestamp"]
    }
  },
  "source_system_column": "source_system",
  "source_timestamp_column": "event_timestamp_utc",
  "reference_joins": [
    {
      "table": "adjuster_lookup",
      "schema": "standardized_data_layer",
      "alias": "adj",
      "join_type": "LEFT",
      "join_condition": "src.adjuster_id = adj.adjuster_id",
      "broadcast": true,
      "columns": ["adjuster_id", "adjuster_name", "adjuster_region"]
    }
  ]
}
